<?xml version="1.0" encoding="utf-8"?>
<!-- 
<!-- Include this file after defining "RepoRoot" and "AssemblyName" -->
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup>
    <PlatformName Condition=" '$(MC_PLATFORM)' != '' ">$(MC_PLATFORM)</PlatformName>
    <PlatformName Condition=" '$(MC_PLATFORM)' == '' ">mingw64</PlatformName>
    <PlatformPackageDir>$(RepoRoot)/$(PlatformName)-packages</PlatformPackageDir>
  </PropertyGroup>

  <Choose>
    <When Condition=" '$(IS_WINDOWS)' == '1' ">
      <PropertyGroup>
        <!-- Location of .NET Compiler Platform (Roslyn) assemblies -->
        <RoslynRefPath>$(PlatformPackageDir)\roslyn</RoslynRefPath>

        <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
      </PropertyGroup>
    </When>
    <Otherwise>
      <PropertyGroup>
        <TargetFrameworkVersion>v4.0</TargetFrameworkVersion>
        <TargetFrameworkProfile>Client</TargetFrameworkProfile>
      </PropertyGroup>
    </Otherwise>
  </Choose>

  <PropertyGroup>
    <!-- For building from Visual Studio -->
    <ObjsDir Condition=" '$(OBJ_DIR)' == '' ">$(RepoRoot)\objs\$(PlatformName)</ObjsDir>

    <!-- For building from make -->
    <ObjsDir Condition="'$(OBJ_DIR)' != ''">$(RepoRoot)\$(OBJ_DIR)</ObjsDir>
    <CovBinDir Condition="'$(CSHARP_BIN_DIR)' != ''">$(RepoRoot)\$(CSHARP_BIN_DIR)</CovBinDir>
    <CovBinDir Condition="'$(CSHARP_BIN_DIR)' == ''">$(ObjsDir)\root\bin</CovBinDir>
    <CovTestBinDir>$(ObjsDir)\root\test-bin</CovTestBinDir>
    <OutputPath Condition="'$(TestOnlyTarget)' == 'true'">$(CovTestBinDir)</OutputPath>
    <OutputPath Condition="'$(TestOnlyTarget)' != 'true'">$(CovBinDir)</OutputPath>

    <!-- To avoid storing intermediate files in the project's directory -->
    <IntermediateOutputPath>$(ObjsDir)\objs\$(AssemblyName)\</IntermediateOutputPath>
    <BaseIntermediateOutputPath>$(ObjsDir)\objs\$(AssemblyName)</BaseIntermediateOutputPath>

    <!-- Define MONO_RUNTIME if going to run under Mono -->
    <RuntimeDefines Condition="'$(IS_WINDOWS)' == '1'"></RuntimeDefines>
    <RuntimeDefines Condition="'$(IS_WINDOWS)' != '1'">MONO_RUNTIME</RuntimeDefines>
    <DefineConstants>COVERITY;$(DefineConstants)</DefineConstants>

    <!-- Packages -->
    <PackagesDir>$(RepoRoot)\packages</PackagesDir>
    <CstaPackagesDir>$(PlatformPackageDir)\csta-packages</CstaPackagesDir>
    <OpenCoverPackagesDir>$(CstaPackagesDir)\packages</OpenCoverPackagesDir>
    <OpenCoverTestPackagesDir>$(CstaPackagesDir)\test-packages</OpenCoverTestPackagesDir>
    <OpenCoverSamplesDir>$(CstaPackagesDir)\samples</OpenCoverSamplesDir>
  </PropertyGroup>
</Project>
